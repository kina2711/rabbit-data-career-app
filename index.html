<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>L·ªô Tr√¨nh Data & AI Master - Made by Rabbit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        da: { light: '#fff7ed', DEFAULT: '#ea580c', dark: '#9a3412', border: '#fed7aa' },
                        de: { light: '#f0f9ff', DEFAULT: '#0284c7', dark: '#075985', border: '#bae6fd' },
                        ds: { light: '#faf5ff', DEFAULT: '#9333ea', dark: '#6b21a8', border: '#e9d5ff' },
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'glow': '0 0 15px rgba(14, 165, 233, 0.3)',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
        .tab-btn { position: relative; transition: all 0.3s ease; white-space: nowrap; }
        .tab-btn::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0%; height: 2px; background-color: currentColor; transition: width 0.3s ease; }
        .tab-btn.active::after { width: 100%; }
        
        /* Module specific styles */
        .module-card { transition: all 0.2s ease-in-out; }
        .module-header { cursor: pointer; user-select: none; }
        .module-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .module-content.open { max-height: 1000px; transition: max-height 0.5s ease-in; }
        .rotate-icon { transition: transform 0.3s; }
        .rotate-icon.open { transform: rotate(180deg); }

        .ai-response ul { list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem; }
        .ai-response li { margin-bottom: 0.25rem; }
        .typing-dot { animation: typing 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    </style>
</head>
<body class="text-slate-700">

    <!-- Navbar -->
    <nav class="bg-white/95 backdrop-blur-md sticky top-0 z-50 border-b border-slate-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-slate-900 rounded-lg flex items-center justify-center text-white font-bold shadow-lg">D</div>
                    <span class="text-xl font-bold text-slate-900 tracking-tight">Data<span class="text-sky-600">Mastery</span></span>
                </div>
                <div class="hidden md:flex space-x-6" id="nav-tabs-desktop"></div>
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-slate-600 hover:text-slate-900 p-2 focus:outline-none">
                        <svg id="menu-icon" class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                        <svg id="close-icon" class="w-7 h-7 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden absolute top-16 left-0 w-full bg-white border-b border-slate-200 shadow-xl animate-fade-in">
            <div class="flex flex-col p-4 space-y-2" id="nav-tabs-mobile"></div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-10 min-h-screen">
        <div id="app-container" class="animate-fade-in pb-10"></div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-200 py-8 bg-white mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center text-slate-400 text-sm">
            <p>¬© 2025 Data Mastery Path. Powered by Rabbit.</p>
        </div>
    </footer>

    <script>
        // --- API CALLING LOGIC ---
        async function callGeminiAPI(prompt) {
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: prompt })
                });
                if (!response.ok) throw new Error("L·ªói k·∫øt n·ªëi");
                const data = await response.json();
                return data.reply;
            } catch (error) {
                return "L·ªói k·∫øt n·ªëi AI. Vui l√≤ng ki·ªÉm tra l·∫°i m·∫°ng ho·∫∑c API Key.";
            }
        }

        // --- UPDATED DATA STORE ---
        const data = {
            overview: {
                roles: [
                    { id: 'DE', name: 'Data Engineer', color: 'de', icon: '‚öôÔ∏è', focus: 'Ki·∫øn tr√∫c s∆∞ & X√¢y d·ª±ng', desc: 'X√¢y d·ª±ng pipeline (Ingest, Store, Transform). ƒê·∫£m b·∫£o d·ªØ li·ªáu tin c·∫≠y, ch·∫•t l∆∞·ª£ng cao.' },
                    { id: 'DA', name: 'Data Analyst', color: 'da', icon: 'üìä', focus: 'Phi√™n d·ªãch & K·ªÉ chuy·ªán', desc: 'Tr·∫£ l·ªùi "ƒêi·ªÅu g√¨ ƒë√£ x·∫£y ra?". Bi·∫øn d·ªØ li·ªáu tinh ch·∫ø th√†nh insights kinh doanh.' },
                    { id: 'DS', name: 'Data Scientist', color: 'ds', icon: 'ü§ñ', focus: 'ƒê·ªïi m·ªõi & D·ª± b√°o', desc: 'Tr·∫£ l·ªùi "ƒêi·ªÅu g√¨ s·∫Ω x·∫£y ra?". X√¢y d·ª±ng m√¥ h√¨nh ML/DL ƒë·ªÉ d·ª± ƒëo√°n t∆∞∆°ng lai.' }
                ]
            },
            // --- NEW: STUDY MODULES FRAMEWORK ---
            studyModules: [
                {
                    level: "Level 1: N·ªÅn T·∫£ng C·ªët L√µi (Core Foundation)",
                    desc: "B·ªô khung ki·∫øn th·ª©c b·∫Øt bu·ªôc cho m·ªçi vai tr√≤ (DA/DE/DS).",
                    color: "slate",
                    modules: [
                        {
                            id: "m1_math", title: "Module 1: To√°n h·ªçc & Th·ªëng k√™ ·ª®ng d·ª•ng", icon: "Œ£",
                            lessons: [
                                { title: "B√†i 1: ƒê·∫°i s·ªë tuy·∫øn t√≠nh (Ma tr·∫≠n, Vector)", status: "empty" },
                                { title: "B√†i 2: Gi·∫£i t√≠ch c∆° b·∫£n (ƒê·∫°o h√†m, T√≠ch ph√¢n)", status: "empty" },
                                { title: "B√†i 3: Th·ªëng k√™ m√¥ t·∫£ (Mean, Median, Variance)", status: "empty" },
                                { title: "B√†i 4: Th·ªëng k√™ suy lu·∫≠n & Ki·ªÉm ƒë·ªãnh gi·∫£ thuy·∫øt", status: "empty" }
                            ]
                        },
                        {
                            id: "m2_cs", title: "Module 2: Khoa h·ªçc m√°y t√≠nh & L·∫≠p tr√¨nh", icon: "üíª",
                            lessons: [
                                { title: "B√†i 1: T∆∞ duy l·∫≠p tr√¨nh & C·∫•u tr√∫c d·ªØ li·ªáu", status: "empty" },
                                { title: "B√†i 2: Git & Qu·∫£n l√Ω phi√™n b·∫£n (Version Control)", status: "empty" },
                                { title: "B√†i 3: Python c∆° b·∫£n cho x·ª≠ l√Ω d·ªØ li·ªáu", status: "empty" },
                                { title: "B√†i 4: Linux Command Line c∆° b·∫£n", status: "empty" }
                            ]
                        },
                        {
                            id: "m3_db", title: "Module 3: C∆° s·ªü d·ªØ li·ªáu (Database)", icon: "üóÑÔ∏è",
                            lessons: [
                                { title: "B√†i 1: T∆∞ duy SQL & Truy v·∫•n c∆° b·∫£n", status: "empty" },
                                { title: "B√†i 2: SQL N√¢ng cao (Window Functions, CTEs)", status: "empty" },
                                { title: "B√†i 3: Data Modeling (Star & Snowflake Schema)", status: "empty" },
                                { title: "B√†i 4: Ph√¢n bi·ªát SQL (Relational) v√† NoSQL", status: "empty" }
                            ]
                        }
                    ]
                },
                {
                    level: "Level 2: V√≤ng ƒê·ªùi & C√¥ng C·ª• (Lifecycle & Tools)",
                    desc: "Hi·ªÉu d√≤ng ch·∫£y d·ªØ li·ªáu v√† c√°c c√¥ng c·ª• trong th·ª±c t·∫ø.",
                    color: "sky",
                    modules: [
                        {
                            id: "m4_ingest", title: "Module 4: Thu th·∫≠p d·ªØ li·ªáu (Ingestion)", icon: "üì•",
                            lessons: [
                                { title: "B√†i 1: Batch vs Streaming Ingestion", status: "empty" },
                                { title: "B√†i 2: Th·ª±c h√†nh Fivetran (SaaS EL)", status: "empty" },
                                { title: "B√†i 3: Th·ª±c h√†nh Airbyte (Open Source EL)", status: "empty" }
                            ]
                        },
                        {
                            id: "m5_store", title: "Module 5: L∆∞u tr·ªØ & Data Warehousing", icon: "üíæ",
                            lessons: [
                                { title: "B√†i 1: Ki·∫øn tr√∫c Data Lakehouse", status: "empty" },
                                { title: "B√†i 2: Google BigQuery (Serverless DW)", status: "empty" },
                                { title: "B√†i 3: AWS Redshift (Cluster DW)", status: "empty" }
                            ]
                        },
                        {
                            id: "m6_trans", title: "Module 6: Chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu (Transformation)", icon: "üîÑ",
                            lessons: [
                                { title: "B√†i 1: Gi·ªõi thi·ªáu dbt (Data Build Tool)", status: "empty" },
                                { title: "B√†i 2: Apache Spark cho Big Data", status: "empty" }
                            ]
                        },
                        {
                            id: "m7_orch", title: "Module 7: ƒêi·ªÅu ph·ªëi (Orchestration)", icon: "‚è±Ô∏è",
                            lessons: [
                                { title: "B√†i 1: Apache Airflow (Static DAGs)", status: "empty" },
                                { title: "B√†i 2: Prefect (Modern Workflow)", status: "empty" }
                            ]
                        }
                    ]
                },
                {
                    level: "Level 3: Chuy√™n S√¢u & Th·ª±c Chi·∫øn (Mastery)",
                    desc: "Ki·∫øn th·ª©c n√¢ng cao cho t·ª´ng nh√°nh ngh·ªÅ nghi·ªáp.",
                    color: "purple",
                    modules: [
                        {
                            id: "m8_da", title: "Module 8: Data Analytics & Storytelling", icon: "üìä",
                            lessons: [
                                { title: "B√†i 1: PowerBI/Tableau n√¢ng cao", status: "empty" },
                                { title: "B√†i 2: Ngh·ªá thu·∫≠t Data Storytelling", status: "empty" },
                                { title: "B√†i 3: Ph√¢n t√≠ch kinh doanh (Cohort, RFM)", status: "empty" }
                            ]
                        },
                        {
                            id: "m9_ds", title: "Module 9: Data Science & AI", icon: "ü§ñ",
                            lessons: [
                                { title: "B√†i 1: Machine Learning v·ªõi Scikit-learn", status: "empty" },
                                { title: "B√†i 2: Deep Learning (PyTorch/TensorFlow)", status: "empty" },
                                { title: "B√†i 3: MLOps & Feature Store", status: "empty" }
                            ]
                        },
                        {
                            id: "m10_cap", title: "Module 10: ƒê·ªì √°n t·ªët nghi·ªáp (Capstone)", icon: "üéì",
                            lessons: [
                                { title: "ƒê·ªÅ b√†i: X√¢y d·ª±ng Pipeline End-to-End", status: "empty" },
                                { title: "H∆∞·ªõng d·∫´n: T√≠ch h·ª£p API -> BigQuery -> dbt -> Dashboard", status: "empty" }
                            ]
                        }
                    ]
                }
            ],
            // ... (Gi·ªØ l·∫°i c√°c d·ªØ li·ªáu c≈© cho c√°c tab kh√°c n·∫øu c·∫ßn)
            roadmap: {
                 base: [ { title: 'To√°n & Th·ªëng k√™', items: ['ƒê·∫°i s·ªë tuy·∫øn t√≠nh', 'X√°c su·∫•t', 'Th·ªëng k√™'], icon: '‚àë' }, { title: 'CS & DB', items: ['SQL', 'Python', 'Git'], icon: 'üíª' } ],
                 paths: { DA: [{ stage: 'X·ª≠ l√Ω', content: 'Excel, SQL' }, { stage: 'Visual', content: 'PowerBI' }], DE: [{ stage: 'Code', content: 'Python, Spark' }, { stage: 'Cloud', content: 'AWS' }], DS: [{ stage: 'ML', content: 'Sklearn' }, { stage: 'DL', content: 'PyTorch' }] }
            },
            lifecycle: [
                { id: 'ingest', step: '01', title: 'Thu Th·∫≠p', role: 'DE', short: 'Ingest', desc: 'Fivetran, Airbyte.', tech: [], mindset: 'Reliability' },
                { id: 'store', step: '02', title: 'L∆∞u Tr·ªØ', role: 'DE', short: 'Store', desc: 'BigQuery, Redshift.', tech: [], mindset: 'Scalability' },
                { id: 'transform', step: '03', title: 'Chuy·ªÉn ƒê·ªïi', role: 'DE', short: 'Transform', desc: 'dbt, Spark.', tech: [], mindset: 'Quality' },
                { id: 'orchestrate', step: '04', title: 'ƒêi·ªÅu Ph·ªëi', role: 'DE', short: 'Orchestrate', desc: 'Airflow, Prefect.', tech: [], mindset: 'Automation' },
                { id: 'analyze', step: '05', title: 'Ph√¢n T√≠ch', role: 'DA/DS', short: 'Analyze', desc: 'Tableau, ML.', tech: [], mindset: 'Value' }
            ]
        };

        let state = { tab: 'modules', roadmapRole: 'DA', lifecycleStepIndex: 0, chatHistory: [], mobileMenuOpen: false };

        // --- UI FUNCTIONS ---
        function toggleModule(id) {
            const content = document.getElementById(`content-${id}`);
            const icon = document.getElementById(`icon-${id}`);
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                icon.classList.remove('open');
            } else {
                content.classList.add('open');
                icon.classList.add('open');
            }
        }

        function toggleMobileMenu() {
            state.mobileMenuOpen = !state.mobileMenuOpen;
            const menu = document.getElementById('mobile-menu');
            const menuIcon = document.getElementById('menu-icon');
            const closeIcon = document.getElementById('close-icon');
            if (state.mobileMenuOpen) {
                menu.classList.remove('hidden');
                menuIcon.classList.add('hidden');
                closeIcon.classList.remove('hidden');
            } else {
                menu.classList.add('hidden');
                menuIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
        }

        function setTab(tabId) {
            state.tab = tabId;
            state.mobileMenuOpen = false;
            document.getElementById('mobile-menu').classList.add('hidden');
            document.getElementById('menu-icon').classList.remove('hidden');
            document.getElementById('close-icon').classList.add('hidden');
            renderTabs();
            renderContent();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function renderTabs() {
            const tabs = [
                { id: 'modules', label: 'Ch∆∞∆°ng Tr√¨nh H·ªçc' }, // Tab m·ªõi ƒë∆∞a l√™n ƒë·∫ßu
                { id: 'roadmap', label: 'L·ªô Tr√¨nh' },
                { id: 'lifecycle', label: 'V√≤ng ƒê·ªùi' },
                { id: 'ai_mentor', label: 'AI Mentor' }
            ];
            
            document.getElementById('nav-tabs-desktop').innerHTML = tabs.map(t => 
                `<button onclick="setTab('${t.id}')" class="tab-btn px-3 py-2 text-sm font-medium ${state.tab === t.id ? 'text-sky-600 active font-bold' : 'text-slate-500 hover:text-slate-700'}">${t.label}</button>`
            ).join('');

            document.getElementById('nav-tabs-mobile').innerHTML = tabs.map(t => 
                `<button onclick="setTab('${t.id}')" class="w-full text-left px-4 py-3 rounded-lg text-base font-medium ${state.tab === t.id ? 'bg-sky-50 text-sky-700 font-bold' : 'text-slate-600 hover:bg-slate-50'}">${t.label}</button>`
            ).join('');
        }

        function renderContent() {
            const container = document.getElementById('app-container');
            container.innerHTML = '';

            if(state.tab === 'modules') renderModules(container);
            else if(state.tab === 'roadmap') renderRoadmap(container);
            else if(state.tab === 'lifecycle') renderLifecycle(container);
            else if(state.tab === 'ai_mentor') renderAIMentor(container);
        }

        // --- NEW: RENDER MODULES ---
        function renderModules(container) {
            container.innerHTML = `
                <div class="text-center mb-10">
                    <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900 mb-2">Ch∆∞∆°ng Tr√¨nh ƒê√†o T·∫°o</h1>
                    <p class="text-slate-500">H·ªá th·ªëng b√†i gi·∫£ng t·ª´ n·ªÅn t·∫£ng ƒë·∫øn chuy√™n s√¢u.</p>
                </div>
            `;

            data.studyModules.forEach((level, levelIdx) => {
                let sectionHTML = `
                    <div class="mb-10 animate-fade-in" style="animation-delay: ${levelIdx * 0.1}s">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="px-3 py-1 rounded-full bg-${level.color}-100 text-${level.color}-700 text-xs font-bold uppercase tracking-wider">Giai ƒëo·∫°n ${levelIdx + 1}</span>
                            <h2 class="text-xl md:text-2xl font-bold text-slate-800">${level.level}</h2>
                        </div>
                        <p class="text-slate-500 text-sm mb-6 ml-1">${level.desc}</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                `;

                level.modules.forEach(mod => {
                    sectionHTML += `
                        <div class="bg-white border border-slate-200 rounded-xl shadow-sm module-card overflow-hidden">
                            <div class="p-5 flex justify-between items-center module-header hover:bg-slate-50 transition-colors" onclick="toggleModule('${mod.id}')">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-${level.color}-50 text-${level.color}-600 flex items-center justify-center text-xl">
                                        ${mod.icon}
                                    </div>
                                    <h3 class="font-bold text-slate-700 text-sm md:text-base">${mod.title}</h3>
                                </div>
                                <svg id="icon-${mod.id}" class="w-5 h-5 text-slate-400 rotate-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                            
                            <div id="content-${mod.id}" class="module-content bg-slate-50 border-t border-slate-100">
                                <div class="p-4 space-y-2">
                                    ${mod.lessons.map(lesson => `
                                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 border-dashed group cursor-pointer hover:border-sky-300 transition-colors">
                                            <div class="w-6 h-6 rounded-full bg-slate-100 text-slate-400 flex items-center justify-center text-xs">
                                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                                            </div>
                                            <div class="flex-1">
                                                <span class="text-sm font-medium text-slate-600 group-hover:text-sky-700">${lesson.title}</span>
                                            </div>
                                            <span class="text-[10px] text-slate-400 italic">Tr·ªëng</span>
                                        </div>
                                    `).join('')}
                                    <div class="mt-2 text-center">
                                        <button class="text-xs text-sky-600 font-medium hover:underline" onclick="alert('T√≠nh nƒÉng ch·ªânh s·ª≠a b√†i gi·∫£ng s·∫Ω s·ªõm ra m·∫Øt!')">+ Th√™m n·ªôi dung b√†i gi·∫£ng</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                sectionHTML += `</div></div>`;
                container.innerHTML += sectionHTML;
            });
        }

        // --- OTHER RENDERERS (Simplified for brevity, same logic as before) ---
        function renderRoadmap(container) {
            container.innerHTML = `<div class="text-center py-20 text-slate-500">Chuy·ªÉn sang tab "Ch∆∞∆°ng Tr√¨nh H·ªçc" ƒë·ªÉ xem c·∫•u tr√∫c b√†i gi·∫£ng chi ti·∫øt h∆°n.</div>`;
        }
        function renderLifecycle(container) {
             const step = data.lifecycle[0]; // Demo
             container.innerHTML = `<div class="text-center py-20 text-slate-500">V√≤ng ƒë·ªùi d·ªØ li·ªáu (Xem chi ti·∫øt ·ªü tab Ch∆∞∆°ng Tr√¨nh H·ªçc - Module 4,5,6,7).</div>`;
        }
        function renderAIMentor(container) {
             container.innerHTML = `
                <div class="flex flex-col h-[600px] gap-4">
                    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-xl shadow-md text-center">
                        <h3 class="font-bold text-lg mb-2">Tr·ª£ l√Ω AI So·∫°n Gi√°o √Ån</h3>
                        <p class="text-sm text-purple-100 mb-4">D√πng AI ƒë·ªÉ g·ª£i √Ω n·ªôi dung chi ti·∫øt cho c√°c Module tr·ªëng c·ªßa b·∫°n.</p>
                        <div class="flex gap-2 justify-center">
                            <button onclick="triggerAIPrompt('H√£y so·∫°n ƒë·ªÅ c∆∞∆°ng chi ti·∫øt cho b√†i: ƒê·∫°i s·ªë tuy·∫øn t√≠nh trong Data Science')" class="bg-white text-indigo-700 px-4 py-2 rounded-full text-xs font-bold hover:bg-indigo-50">So·∫°n b√†i To√°n</button>
                            <button onclick="triggerAIPrompt('G·ª£i √Ω n·ªôi dung b√†i gi·∫£ng v·ªÅ dbt (Data Build Tool)')" class="bg-white text-indigo-700 px-4 py-2 rounded-full text-xs font-bold hover:bg-indigo-50">So·∫°n b√†i dbt</button>
                        </div>
                    </div>
                    <div class="flex-1 bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col overflow-hidden">
                        <div id="ai-chat-box" class="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50">
                             <!-- Chat messages -->
                        </div>
                        <div class="p-3 bg-white border-t border-slate-200">
                            <form onsubmit="handleAIChat(event)" class="flex gap-2">
                                <input id="ai-input" type="text" placeholder="Nh·∫≠p y√™u c·∫ßu so·∫°n b√†i..." class="flex-1 px-4 py-2 rounded-xl border border-slate-200 text-sm">
                                <button type="submit" class="bg-slate-900 text-white px-4 rounded-xl">G·ª≠i</button>
                            </form>
                        </div>
                    </div>
                </div>
             `;
        }

        // --- HANDLERS (Same as before) ---
        async function handleAIChat(e) {
            e.preventDefault();
            const input = document.getElementById('ai-input');
            const msg = input.value.trim();
            if (!msg) return;
            // (Add logic to append user msg)
            const chatBox = document.getElementById('ai-chat-box');
            chatBox.innerHTML += `<div class="text-right mb-2"><span class="bg-slate-800 text-white px-3 py-2 rounded-lg text-sm inline-block">${msg}</span></div>`;
            input.value = '';
            
            const aiText = await callGeminiAPI(msg);
            const fmt = aiText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\* (.*?)\n/g, '<li>$1</li>').replace(/\n/g, '<br>');
            chatBox.innerHTML += `<div class="text-left mb-2"><div class="bg-white border border-slate-200 text-slate-700 px-3 py-2 rounded-lg text-sm inline-block ai-response">${fmt}</div></div>`;
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        window.triggerAIPrompt = (p) => { document.getElementById('ai-input').value = p; handleAIChat({ preventDefault: () => {} }); };

        document.addEventListener('DOMContentLoaded', () => {
            renderTabs();
            renderContent();
        });
    </script>
</body>
</html>
